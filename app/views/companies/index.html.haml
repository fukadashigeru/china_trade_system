#companies_index
  .row.mt-4
    .col
      .h5.font-weight-bold 自分がオーナーの会社
      .owner_company_block.ml-4
        - if @owner_company_users.present?
          %table.table.table-bordered.mt-1#owner_company_table
            %thead.thead-light
              %tr
                %th 会社名
                %th 会社アカウントタイプ
                %th.th_member メンバー/メンバーアカウントタイプ
                %th メンバー招待
                %th 編集
                %th ログイン
            %tbody
              - @owner_company_users.each do |company_user|
                - company = company_user.company
                - user = company_user.user
                %tr
                  %td.align-middle= company&.name
                  %td.align-middle
                    - if company.is_japanese_retailer_account == "japanese_retailer"
                      %p= I18n.t("activerecord.attributes.company.is_japanese_retailer_account.#{company.is_japanese_retailer_account}", locale: :ja)
                    - if company.is_chinese_buyer_account == "chinese_buyer"
                      %p= I18n.t("activerecord.attributes.company.is_chinese_buyer_account.#{company.is_chinese_buyer_account}", locale: :ja)
                  %td.align-middle
                    %table
                      %tbody
                        - company.company_users.each do |company_user|
                          - user = company_user.user
                          - role = I18n.t("activerecord.attributes.company_user.role.#{company_user.role}", locale: :ja)
                          -# .p.text-break= user.name ? user.name + role : user.email + role
                          %tr
                            %td.w-50.text-break= user.name ? user.name : user.email
                            %td.w-50.text-break= role
                        - company.invited_company_users.each do |invited_company_user|
                          - user = invited_company_user.user
                          - role =  I18n.t("activerecord.attributes.company_user.role.#{invited_company_user.role}", locale: :ja)
                          -# .p.text-break= user.name ? user.name + role : user.email + role
                          %tr
                            %td.w-50.text-break= user.name ? user.name : user.email
                            %td.w-50.text-break= role
                  %td.align-middle
                    -# = link_to new_invited_company_user_path(company_id: company.id), remote: true, class: "btn btn-primary" do
                    -#   招待
                    -#   %i.fas.fa-address-card
                    = link_to new_user_invitation_path(company_id: company.id), remote: true, class: "btn btn-primary" do
                      招待
                      %i.fas.fa-address-card
                  %td.align-middle
                    = link_to edit_company_path(company), remote: true, class: "btn btn-primary" do
                      編集
                      %i.fas.fa-edit.fa-lg
                  %td.align-middle
                    = link_to login_companies_path(company_id: company.id), class: "btn btn-success" do
                      ログイン
                      %i.fas.fa-sign-in-alt.fa-lg
                  -# %td.align-middle
                  -#   = link_to "メンバー招待", new_user_invitation_path(company_id: company.id), class: "btn btn-warning"
        - else
          .h6 自分がオーナーの会社はありません。
        = link_to "会社新規作成", new_company_path, remote: true, class: "btn btn-outline-success"
        
  .row.mt-5
    .col
      .h5.font-weight-bold 所属会社
      .belong_company_block.ml-4
        - if  @belong_company_users.present?
          %table.table.table-bordered#belong_company_table
            %thead.thead-light
              %tr
                %th 会社名
                %th アカウントタイプ
                %th オーナー
                %th 編集
                %th ログイン
            %tbody
              -@belong_company_users.each do |company_user|
                %tr
                  %td.align-middle= company_user.company&.name
                  %td.align-middle
                  %td.align-middle
                    - company_user.company.owner.each do |user|
                      .p= user.name
                  %td.align-middle
                  %td.align-middle
                    = link_to login_companies_path(company_id: company_user.company.id), class: "btn btn-success" do
                      ログイン
                      %i.fas.fa-sign-in-alt.fa-lg
        - else
          .h6 所属会社はありません。
  -if @invited_company_users.present?
    .row.mt-5
      .col-3
        .h5.font-weight-bold 所属が招待されている会社
        .belong_company_block.ml-4
          %table.table.table-bordered#belong_company_table
            %thead.thead-light
              %tr
                %th 会社名
                %th 招待認証
            %tbody
              -@invited_company_users.each do |invited_company_users|
                %tr
                  %td= invited_company_users.company.name
                  %td= link_to "招待認証", invited_company_user_path(invited_company_users), method: :delete, class: "btn btn-success"



